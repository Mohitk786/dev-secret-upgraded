(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5492],{276:(e,t,a)=>{"use strict";a.d(t,{Af:()=>c,B3:()=>n,Px:()=>r,YT:()=>i,iF:()=>l});var s=a(3084);let l=async()=>{var e;return null==(e=(await s.S.get("/vaults/all")).data)?void 0:e.vaults},r=async e=>{var t;return null==(t=(await s.S.get("/vaults/".concat(e))).data)?void 0:t.vault},n=async e=>(await s.S.post("/vaults/create",e)).data,i=async e=>{let{vaultId:t,data:a}=e;return(await s.S.put("/vaults/".concat(t),a)).data},c=async e=>{try{var t;return null==(t=(await s.S.get("/vaults/".concat(e,"/vault-key"))).data)?void 0:t.vaultKey}catch(e){return null}}},1025:(e,t,a)=>{"use strict";a.d(t,{Gy:()=>i,Vn:()=>c,pE:()=>d,si:()=>n});var s=a(1416),l=a(5753),r=a(276);let n=(e,t)=>{let{data:a,isLoading:r,error:n,refetch:i}=(0,s.I)({queryKey:["invites",e,t],queryFn:()=>(0,l.Bf)(e,t)});return{data:a,isLoading:r,error:n,refetch:i}},i=()=>{let{data:e,isLoading:t,error:a,refetch:r}=(0,s.I)({queryKey:["shared-vaults"],queryFn:l.B_});return{data:e,isLoading:t,error:a,refetch:r}},c=e=>(0,s.I)({queryKey:["vault-collaborators",e],queryFn:()=>(0,l.it)(e),enabled:!!e}),d=e=>(0,s.I)({queryKey:["vault-key",e],queryFn:()=>(0,r.Af)(e),enabled:!!e})},1217:(e,t,a)=>{"use strict";a.d(t,{MG:()=>n,XT:()=>i,rn:()=>r});var s=a(276),l=a(2905);let r=async()=>await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),n=async(e,t)=>{let a=await (0,s.Af)(t),r=await (0,l.v)(a);if(!r)throw Error("Vault key not found");let n=JSON.stringify(e),i=crypto.getRandomValues(new Uint8Array(12)),c=new TextEncoder().encode(n),d=await crypto.subtle.encrypt({name:"AES-GCM",iv:i},r,c),o=new Uint8Array(i.byteLength+d.byteLength);return o.set(i,0),o.set(new Uint8Array(d),i.byteLength),btoa(String.fromCharCode(...o))},i=async(e,t)=>{let a=await crypto.subtle.exportKey("raw",t),s=Uint8Array.from(atob(e),e=>e.charCodeAt(0)).buffer,l=await crypto.subtle.importKey("spki",s,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]);return btoa(String.fromCharCode(...new Uint8Array(await crypto.subtle.encrypt({name:"RSA-OAEP"},l,a))))}},2555:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var s=a(4568),l=a(7620),r=a(6559),n=a(615),i=a(3928);let c=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.b,{ref:t,className:(0,i.cn)(c(),a),...l})});d.displayName=r.b.displayName},2602:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(7620);let l=(0,a(1405).io)("ws://localhost:8000",{transports:["websocket"],withCredentials:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3}),r={socket:l,connect:()=>{l.connect()}},n=null,i=()=>{let e=(0,s.useRef)(null);return n||(r.connect(),n=r.socket),e.current=n,(0,s.useEffect)(()=>((null==n?void 0:n.connected)||r.connect(),()=>{}),[]),e.current}},2905:(e,t,a)=>{"use strict";a.d(t,{a:()=>r,v:()=>l});var s=a(9305);let l=async e=>{let t=await (0,s.Tn)();if(!t)throw Error("Private key missing!");let a=Uint8Array.from(atob(e),e=>e.charCodeAt(0)),l=Uint8Array.from(atob(t),e=>e.charCodeAt(0)).buffer,r=await crypto.subtle.importKey("pkcs8",l,{name:"RSA-OAEP",hash:"SHA-256"},!0,["decrypt"]),n=await crypto.subtle.decrypt({name:"RSA-OAEP"},r,a);return await crypto.subtle.importKey("raw",n,{name:"AES-GCM"},!0,["encrypt","decrypt"])},r=async(e,t)=>{let a=e.encryptedSecret,s=Uint8Array.from(atob(a),e=>e.charCodeAt(0)),l=s.slice(0,12),r=s.slice(12),n=await crypto.subtle.decrypt({name:"AES-GCM",iv:l},t,r);return{...JSON.parse(new TextDecoder().decode(n)),id:e.id,vaultId:e.vaultId}}},3353:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>n,aR:()=>i,wL:()=>u});var s=a(4568),l=a(7620),r=a(3928);let n=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...l})});n.displayName="Card";let i=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...l})});i.displayName="CardHeader";let c=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("font-semibold leading-none tracking-tight",a),...l})});c.displayName="CardTitle";let d=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...l})});d.displayName="CardDescription";let o=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",a),...l})});o.displayName="CardContent";let u=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",a),...l})});u.displayName="CardFooter"},4675:(e,t,a)=>{"use strict";a.d(t,{bq:()=>m,eb:()=>h,gC:()=>v,l6:()=>o,yv:()=>u});var s=a(4568),l=a(7620),r=a(5284),n=a(4711),i=a(6430),c=a(4931),d=a(3928);let o=r.bL;r.YJ;let u=r.WT,m=l.forwardRef((e,t)=>{let{className:a,children:l,...i}=e;return(0,s.jsxs)(r.l9,{ref:t,className:(0,d.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[l,(0,s.jsx)(r.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.l9.displayName;let x=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let p=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=r.wn.displayName;let v=l.forwardRef((e,t)=>{let{className:a,children:l,position:n="popper",...i}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,s.jsx)(x,{}),(0,s.jsx)(r.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,s.jsx)(p,{})]})})});v.displayName=r.UC.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.JU,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",a),...l})}).displayName=r.JU.displayName;let h=l.forwardRef((e,t)=>{let{className:a,children:l,...n}=e;return(0,s.jsxs)(r.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(r.VF,{children:(0,s.jsx)(c.A,{className:"h-4 w-4"})})}),(0,s.jsx)(r.p4,{children:l})]})});h.displayName=r.q7.displayName,l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...l})}).displayName=r.wv.displayName},5165:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(4568),l=a(7620),r=a(3928);let n=l.forwardRef((e,t)=>{let{className:a,type:l,...n}=e;return(0,s.jsx)("input",{type:l,className:(0,r.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});n.displayName="Input"},5186:(e,t,a)=>{"use strict";a.d(t,{default:()=>eN,E:()=>ey});var s=a(4568),l=a(7620),r=a(2942),n=a(8359),i=a(5725),c=a(5165),d=a(7227),o=a(4675),u=a(7129),m=a(7606),x=a(6258),p=a(3084);let v=async e=>(await p.S.post("/secrets/create",e)).data;var h=a(5431),f=a(8284);let y=()=>{let e=(0,m.jE)(),{showToast:t}=(0,f.A)();return(0,x.n)({mutationFn:v,onSuccess:(t,a)=>{e.invalidateQueries({queryKey:[h.e.VAULTS]}),e.invalidateQueries({queryKey:h.e.VAULT(a.vaultId)})},onError:e=>{var a,s;return t({type:"error",message:(null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Error creating secret"})}})};var j=a(9369),N=a(2602),g=a(1217),b=a(60),w=a(1938);let A=[{label:"\uD83E\uDDEA Development",value:"DEVELOPMENT"},{label:"\uD83D\uDD0D Staging",value:"STAGING"},{label:"\uD83D\uDE80 Production",value:"PRODUCTION"}],S=[{label:"\uD83D\uDD11 Generic Secret",value:"GENERIC"},{label:"\uD83D\uDD12 Password",value:"PASSWORD"},{label:"\uD83D\uDD0C API Key",value:"API_KEY"},{label:"⚙️ Environment Variable",value:"ENV_VARIABLE"},{label:"\uD83D\uDEE1️ SSH Key",value:"SSH_KEY"},{label:"\uD83D\uDCBE Database Credential",value:"DATABASE_CREDENTIAL"},{label:"\uD83C\uDF9F️ Token",value:"TOKEN"}],E=e=>{let{open:t,onOpenChange:a}=e,l=y(),m=(0,N.A)(),{showToast:x}=(0,f.A)(),{vaultId:p}=(0,r.useParams)(),v=(0,w.mN)({resolver:(0,b.u)(ey),defaultValues:{key:"",value:"",environment:"DEVELOPMENT",type:"GENERIC"}}),h=async e=>{try{let t=await (0,g.MG)(e,p);m.emit("create-secret",{vaultId:p,encryptedSecret:t}),v.reset(),a(!1)}catch(e){x({type:"error",message:e.message})}};return(0,s.jsx)(n.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(n.Cf,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(n.c7,{children:[(0,s.jsxs)(n.L3,{className:"flex items-center gap-2 text-xl",children:[(0,s.jsx)("span",{children:"\uD83D\uDD10"})," Add New Secret"]}),(0,s.jsx)(n.rr,{children:"Add a new secret to your vault. All secrets are encrypted at rest."})]}),(0,s.jsx)(i.lV,{...v,children:(0,s.jsxs)("form",{onSubmit:v.handleSubmit(h),className:"space-y-5",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i.zB,{control:v.control,name:"type",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.eI,{children:[(0,s.jsx)(i.lR,{children:"Secret Type"}),(0,s.jsxs)(o.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(i.MJ,{children:(0,s.jsx)(o.bq,{children:(0,s.jsx)(o.yv,{placeholder:"Select type"})})}),(0,s.jsx)(o.gC,{children:S.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)(i.C5,{})]})}}),(0,s.jsx)(i.zB,{control:v.control,name:"environment",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.eI,{children:[(0,s.jsx)(i.lR,{children:"Environment"}),(0,s.jsxs)(o.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(i.MJ,{children:(0,s.jsx)(o.bq,{children:(0,s.jsx)(o.yv,{placeholder:"Select environment"})})}),(0,s.jsx)(o.gC,{children:A.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)(i.C5,{})]})}})]}),(0,s.jsx)(i.zB,{control:v.control,name:"key",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.eI,{children:[(0,s.jsx)(i.lR,{children:"Secret Name"}),(0,s.jsx)(i.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g. DATABASE_URL, API_TOKEN, etc.",...t})}),(0,s.jsx)(i.C5,{})]})}}),(0,s.jsx)(i.zB,{control:v.control,name:"value",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.eI,{children:[(0,s.jsx)(i.lR,{children:"Secret Value"}),(0,s.jsx)(i.MJ,{children:(0,s.jsx)(u.T,{placeholder:"Your secret value",className:"font-mono min-h-[100px]",...t})}),(0,s.jsx)(i.C5,{})]})}}),(0,s.jsxs)(n.Es,{children:[(0,s.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(d.$,{type:"submit",disabled:l.isPending,children:l.isPending?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):(0,s.jsx)(s.Fragment,{children:"Save Secret"})})]})]})})]})})};var C=a(7214),I=a(7261),D=a.n(I),R=a(7876),T=a(3425),V=a(2055),P=a(4529),L=a(2879),k=a(1256),O=a(6608),_=a(3385),K=a(8775),U=a(1326);let z=e=>{var t;let{vault:a,setIsAddSecretOpen:l}=e,r=(0,N.A)(),{user:n}=(0,K.h)(),i=(null==a?void 0:a.ownerId)===(null==n?void 0:n.id),c=async e=>{r.emit("delete-vault",{vaultId:e})};return(0,s.jsxs)("div",{className:"flex flex-col space-y-4 sm:flex-row sm:space-y-0 sm:justify-between sm:items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-primary",children:(null==a?void 0:a.icon)||"\uD83D\uDD12"}),null==a?void 0:a.name]}),(0,s.jsx)("p",{className:"text-muted-foreground mt-1",children:null==a?void 0:a.description})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.$,{variant:"outline",size:"sm",className:"gap-1",asChild:!0,children:(0,s.jsxs)(D(),{href:"".concat(U.vc.VAULTS,"/").concat(null==a?void 0:a.id,"/logs"),children:[(0,s.jsx)(T.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"Activity Logs"})]})}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.$,{variant:"outline",size:"sm",className:"gap-1",asChild:!0,children:(0,s.jsxs)(D(),{href:"".concat(U.vc.VAULTS,"/").concat(null==a?void 0:a.id,"/collaborators"),children:[(0,s.jsx)(V.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"Collaborators"})]})}),i||(null==a||null==(t=a.permissions)?void 0:t.canAdd)?(0,s.jsxs)(d.$,{className:"gap-1",onClick:()=>l(!0),children:[(0,s.jsx)(P.A,{className:"h-4 w-4"})," Add Secret"]}):null]}),i?(0,s.jsxs)(R.rI,{children:[(0,s.jsx)(R.ty,{asChild:!0,children:(0,s.jsx)(d.$,{variant:"ghost",size:"icon",children:(0,s.jsx)(L.A,{className:"h-5 w-5"})})}),(0,s.jsxs)(R.SQ,{align:"end",children:[(0,s.jsx)(R._2,{asChild:!0,children:(0,s.jsxs)(D(),{href:"".concat(U.vc.VAULTS,"/").concat(null==a?void 0:a.id,"/edit"),className:"cursor-pointer flex items-center",children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"})," Edit Vault"]})}),(0,s.jsx)(R._2,{asChild:!0,children:(0,s.jsxs)(D(),{href:"".concat(U.vc.VAULTS,"/").concat(null==a?void 0:a.id,"/invite"),className:"cursor-pointer flex items-center",children:[(0,s.jsx)(V.A,{className:"h-4 w-4 mr-2"})," Invite Members"]})}),(0,s.jsxs)(R._2,{children:[(0,s.jsx)(O.A,{className:"h-4 w-4 mr-2"})," Copy Vault ID"]}),(0,s.jsx)(R.mB,{}),(0,s.jsxs)(R._2,{className:"text-destructive focus:text-destructive focus:bg-destructive/10 cursor-pointer",onClick:()=>c(null==a?void 0:a.id),children:[(0,s.jsx)(_.A,{className:"h-4 w-4 mr-2"})," Delete Vault"]})]})]}):null]})]})};var F=a(7554),G=a(3353),B=a(8130),M=a(5958),q=a(9388),J=a(4160),Y=a(3928);let $=J.bL,H=J.l9,W=J.ZL,Z=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(J.hJ,{className:(0,Y.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:t})});Z.displayName=J.hJ.displayName;let Q=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)(W,{children:[(0,s.jsx)(Z,{}),(0,s.jsx)(J.UC,{ref:t,className:(0,Y.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]})});Q.displayName=J.UC.displayName;let X=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,Y.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};X.displayName="AlertDialogHeader";let ee=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,Y.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};ee.displayName="AlertDialogFooter";let et=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(J.hE,{ref:t,className:(0,Y.cn)("text-lg font-semibold",a),...l})});et.displayName=J.hE.displayName;let ea=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(J.VY,{ref:t,className:(0,Y.cn)("text-sm text-muted-foreground",a),...l})});ea.displayName=J.VY.displayName;let es=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(J.rc,{ref:t,className:(0,Y.cn)((0,d.r)(),a),...l})});es.displayName=J.rc.displayName;let el=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(J.ZD,{ref:t,className:(0,Y.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});el.displayName=J.ZD.displayName;var er=a(880),en=a(9305);let ei=er.z.object({key:er.z.string().min(1,{message:"Secret name is required"}),value:er.z.string().min(1,{message:"Secret value is required"}),environment:er.z.enum(["DEVELOPMENT","STAGING","PRODUCTION"]),type:er.z.enum(["GENERIC","PASSWORD","API_KEY","ENV_VARIABLE","SSH_KEY","DATABASE_CREDENTIAL","TOKEN"])}),ec=[{label:"\uD83E\uDDEA Development",value:"DEVELOPMENT"},{label:"\uD83D\uDD0D Staging",value:"STAGING"},{label:"\uD83D\uDE80 Production",value:"PRODUCTION"}],ed=[{label:"\uD83D\uDD11 Generic Secret",value:"GENERIC"},{label:"\uD83D\uDD12 Password",value:"PASSWORD"},{label:"\uD83D\uDD0C API Key",value:"API_KEY"},{label:"⚙️ Environment Variable",value:"ENV_VARIABLE"},{label:"\uD83D\uDEE1️ SSH Key",value:"SSH_KEY"},{label:"\uD83D\uDCBE Database Credential",value:"DATABASE_CREDENTIAL"},{label:"\uD83C\uDF9F️ Token",value:"TOKEN"}],eo=e=>{let{open:t,onOpenChange:a,secret:m}=e,{showToast:x}=(0,f.A)(),p=(0,N.A)(),[v,h]=(0,l.useState)(!1),{vaultId:y}=(0,r.useParams)(),A=(0,w.mN)({resolver:(0,b.u)(ei),defaultValues:{key:(null==m?void 0:m.key)||"",value:(null==m?void 0:m.value)||"",environment:(null==m?void 0:m.environment)||"DEVELOPMENT",type:(null==m?void 0:m.type)||"GENERIC"}});(0,l.useEffect)(()=>{m&&A.reset({key:m.key||"",value:m.value||"",environment:m.environment||"DEVELOPMENT",type:m.type||"GENERIC"})},[m,A]);let S=async e=>{try{h(!0),(0,en.lG)()||x({type:"error",message:"No public key found"});let t=await (0,g.MG)(e,y);p.emit("update-secret",{secretId:m.id,encryptedSecret:t,vaultId:m.vaultId}),a(!1)}catch(e){console.error(e),x({type:"error",message:"Failed to update secret"})}finally{h(!1)}};return(0,s.jsx)(n.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(n.Cf,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(n.c7,{children:[(0,s.jsxs)(n.L3,{className:"flex items-center gap-2 text-xl",children:[(0,s.jsx)("span",{children:"\uD83D\uDD10"})," Edit Secret"]}),(0,s.jsx)(n.rr,{children:"Update your secret details. All secrets are encrypted at rest."})]}),(0,s.jsx)(i.lV,{...A,children:(0,s.jsxs)("form",{onSubmit:A.handleSubmit(S),className:"space-y-5",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i.zB,{control:A.control,name:"type",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.eI,{children:[(0,s.jsx)(i.lR,{children:"Secret Type"}),(0,s.jsxs)(o.l6,{onValueChange:t.onChange,defaultValue:t.value,value:t.value,children:[(0,s.jsx)(i.MJ,{children:(0,s.jsx)(o.bq,{children:(0,s.jsx)(o.yv,{placeholder:"Select type"})})}),(0,s.jsx)(o.gC,{children:ed.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)(i.C5,{})]})}}),(0,s.jsx)(i.zB,{control:A.control,name:"environment",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.eI,{children:[(0,s.jsx)(i.lR,{children:"Environment"}),(0,s.jsxs)(o.l6,{onValueChange:t.onChange,defaultValue:t.value,value:t.value,children:[(0,s.jsx)(i.MJ,{children:(0,s.jsx)(o.bq,{children:(0,s.jsx)(o.yv,{placeholder:"Select environment"})})}),(0,s.jsx)(o.gC,{children:ec.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)(i.C5,{})]})}})]}),(0,s.jsx)(i.zB,{control:A.control,name:"key",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.eI,{children:[(0,s.jsx)(i.lR,{children:"Secret Name"}),(0,s.jsx)(i.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g. DATABASE_URL, API_TOKEN, etc.",...t})}),(0,s.jsx)(i.C5,{})]})}}),(0,s.jsx)(i.zB,{control:A.control,name:"value",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.eI,{children:[(0,s.jsx)(i.lR,{children:"Secret Value"}),(0,s.jsx)(i.MJ,{children:(0,s.jsx)(u.T,{placeholder:"Your secret value",className:"font-mono min-h-[100px]",...t})}),(0,s.jsx)(i.C5,{})]})}}),(0,s.jsxs)(n.Es,{children:[(0,s.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(d.$,{type:"submit",disabled:v,children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):(0,s.jsx)(s.Fragment,{children:"Update Secret"})})]})]})})]})})},eu=e=>{var t,a;let{secret:n,visibleSecrets:i,toggleSecretVisibility:c}=e,{vaultId:o}=(0,r.useParams)(),{showToast:u}=(0,f.A)(),{user:m}=(0,K.h)(),x=(0,N.A)(),[p,v]=(0,l.useState)(!1),[h,y]=(0,l.useState)(!1),[g,b]=(0,l.useState)(null),{data:w}=(0,C._)(o),A=(null==w?void 0:w.ownerId)===(null==m?void 0:m.id),S=(e,t)=>{navigator.clipboard.writeText(e),u({type:"info",message:"\uD83C\uDF89 Copied ".concat(t," to clipboard! Now don't paste in Slack \uD83D\uDE05")})},E=async e=>{try{v(!0),x.emit("delete-secret",{vaultId:o,secretId:e})}catch(e){u({type:"error",message:"Failed to delete secret: ".concat(e.message)})}finally{v(!1)}},I=e=>{b(e),y(!0)};return(0,s.jsxs)("div",{className:"secret-item flex flex-col sm:flex-row  to-secondary/10 p-4 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("h3",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xl",children:{GENERIC:"\uD83D\uDD11",PASSWORD:"\uD83D\uDD12",API_KEY:"\uD83D\uDD0C",ENV_VARIABLE:"⚙️",SSH_KEY:"\uD83D\uDEE1️",DATABASE_CREDENTIAL:"\uD83D\uDCBE",TOKEN:"\uD83C\uDF9F️"}[n.type||"N/A"]||"\uD83D\uDD11"}),n.key]}),(0,s.jsx)("div",{className:"mt-1 flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)("span",{children:{DEVELOPMENT:"\uD83E\uDDEA",STAGING:"\uD83D\uDD0D",PRODUCTION:"\uD83D\uDE80"}[n.environment||"N/A"]||"✨"}),n.environment]})})]}),(0,s.jsxs)("div",{className:"mt-3 sm:mt-0 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"relative bg-secondary px-3 py-1.5 rounded text-sm font-mono overflow-hidden max-w-xs",children:i.includes((null==n?void 0:n.id)||"")?null==n?void 0:n.value:"••••••••••••••••••••••••"}),(0,s.jsx)(d.$,{variant:"ghost",size:"icon",onClick:()=>c((null==n?void 0:n.id)||""),children:i.includes((null==n?void 0:n.id)||"")?(0,s.jsx)(B.A,{className:"h-4 w-4"}):(0,s.jsx)(M.A,{className:"h-4 w-4"})}),(0,s.jsx)(d.$,{variant:"ghost",size:"icon",onClick:()=>S((null==n?void 0:n.value)||"",(null==n?void 0:n.key)||""),children:(0,s.jsx)(O.A,{className:"h-4 w-4"})}),(A||(null==w||null==(t=w.permissions)?void 0:t.canEdit))&&(0,s.jsx)(d.$,{variant:"ghost",size:"icon",onClick:()=>I(n),children:(0,s.jsx)(q.A,{className:"h-4 w-4"})}),(A||(null==w||null==(a=w.permissions)?void 0:a.canDelete))&&(0,s.jsxs)($,{children:[(0,s.jsx)(H,{asChild:!0,children:(0,s.jsx)(d.$,{variant:"ghost",size:"icon",className:"text-destructive",children:(0,s.jsx)(_.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(Q,{children:[(0,s.jsxs)(X,{children:[(0,s.jsx)(et,{children:"Delete Secret"}),(0,s.jsx)(ea,{children:"Are you sure you want to delete this secret? This action cannot be undone."})]}),(0,s.jsxs)(ee,{children:[(0,s.jsx)(el,{children:"Cancel"}),(0,s.jsx)(es,{onClick:()=>E((null==n?void 0:n.id)||""),className:"bg-destructive text-destructive-foreground",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete Secret"})]})]})]})]}),g&&(0,s.jsx)(eo,{open:h,onOpenChange:y,secret:g})]})},em=e=>{let{secrets:t,searchQuery:a,setSearchQuery:l,visibleSecrets:r,toggleSecretVisibility:n,setIsAddSecretOpen:i,isLoading:o,isSharedVault:u}=e;if(o)return(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(j.A,{className:"h-8 w-8 animate-spin text-primary"})});let m=t.filter(e=>{var t,s;return(null==(t=e.key)?void 0:t.toLowerCase().includes(a.toLowerCase()))||(null==(s=e.environment)?void 0:s.toLowerCase().includes(a.toLowerCase()))})||[];return(0,s.jsx)(G.Zp,{children:(0,s.jsxs)(G.Wu,{className:"p-6",children:[(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)(F.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(c.p,{placeholder:"Search secrets...",className:"pl-10",value:a,onChange:e=>l(e.target.value)})]}),(0,s.jsx)("div",{className:"space-y-4",children:m.length>0?m.map((e,t)=>(0,s.jsx)(eu,{isSharedVault:u||!1,secret:e,visibleSecrets:r,toggleSecretVisibility:n},t)):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:a?"No secrets found matching your search.":"No secrets in this vault yet."}),a&&(0,s.jsx)(d.$,{variant:"link",onClick:()=>l(""),className:"mt-2",children:"Clear search"}),!a&&!u&&(0,s.jsxs)(d.$,{variant:"outline",className:"mt-4",onClick:()=>i(!0),children:[(0,s.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Add your first secret"]})]})})]})})},ex=e=>{let{error:t}=e,a=(0,r.useRouter)();return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-[70vh] space-y-4",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-destructive",children:"⚠️ Error Loading Vault"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:t instanceof Error?t.message:"Could not find the requested vault."}),(0,s.jsx)(d.$,{onClick:()=>a.push(U.vc.VAULTS),children:"Back to Vaults"})]})},ep=()=>(0,s.jsx)("div",{className:"space-y-6 animate-pulse",children:(0,s.jsxs)("div",{className:"flex items-center justify-center h-[70vh]",children:[(0,s.jsx)(j.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("span",{className:"ml-2 text-lg",children:"Loading vault details..."})]})});var ev=a(2905),eh=a(1025);let ef=(e,t)=>{let[a,s]=(0,l.useState)(null),[r,n]=(0,l.useState)([]),{showToast:i}=(0,f.A)(),{data:c}=(0,eh.pE)(e);return(0,l.useEffect)(()=>{c&&(async()=>{try{let e=await (0,ev.v)(c);s(e);let a=await Promise.all(t&&t.length>0?t.map(t=>(0,ev.a)(t,e)):[]);n(a)}catch(e){i({type:"error",message:"Error decrypting vault key: ".concat(null==e?void 0:e.message)})}})()},[c,t,i]),{decryptedVaultKey:a,decryptedSecrets:r,setDecryptedSecrets:n}},ey=er.z.object({key:er.z.string().min(1,{message:"Secret name is required"}),value:er.z.string().min(1,{message:"Secret value is required"}),environment:er.z.enum(["DEVELOPMENT","STAGING","PRODUCTION"]),type:er.z.enum(["GENERIC","PASSWORD","API_KEY","ENV_VARIABLE","SSH_KEY","DATABASE_CREDENTIAL","TOKEN"])}),ej=async(e,t)=>({...await (0,ev.a)(e,t),id:e.id,vaultId:e.vaultId}),eN=e=>{var t;let{isSharedVault:a}=e,{vaultId:n}=(0,r.useParams)(),[i,c]=(0,l.useState)(""),[d,o]=(0,l.useState)([]),[u,m]=(0,l.useState)(!1),{showToast:x}=(0,f.A)(),{user:p}=(0,K.h)(),v=(0,r.useRouter)(),{data:h,isLoading:y,error:j}=(0,C._)(n),g=(0,N.A)(),{decryptedVaultKey:b,decryptedSecrets:w,setDecryptedSecrets:A}=ef(n,null==h?void 0:h.secrets),[S,I]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{if((null==h?void 0:h.ownerId)===(null==p?void 0:p.id))I(!0);else{var e;I(null==h||null==(e=h.collaborators)?void 0:e.hasSecretAccess)}},[h,null==p?void 0:p.id]),(0,l.useEffect)(()=>{g.emit("join-vault",n);let e=async e=>{if(!b)return;let t=await ej(e.secret,b);x({type:"info",message:"New secret created! \uD83D\uDD10"}),A(e=>[...e,t])},t=async e=>{A(t=>t.filter(t=>t.id!==(null==e?void 0:e.secretId))),x({type:"success",message:null==e?void 0:e.message})},a=async e=>{if(!b)return;let t=await ej(e.encryptedSecret,b);A(e=>e.map(e=>e.id===t.id?t:e)),x({type:"success",message:"".concat(null==e?void 0:e.message,"\uD83D\uDD10")})},s=async e=>{x({type:"success",message:null==e?void 0:e.message}),(null==e?void 0:e.hasSecretAccess)?(null==h?void 0:h.secrets)&&b&&(A(await Promise.all(h.secrets.map(e=>(0,ev.a)(e,b)))),I(!0)):(A([]),o([]),I(!1))},l=async e=>{(null==h?void 0:h.ownerId)===(null==p?void 0:p.id)?v.push(U.vc.VAULTS):v.push(U.vc.SHARED_WITH_ME),x({type:"success",message:null==e?void 0:e.message})};return g.on("vault-deleted",l),g.on("access-toggled",s),g.on("secret-created",e),g.on("secret-deleted",t),g.on("secret-updated",a),()=>{g.off("secret-created",e),g.off("secret-deleted",t),g.off("secret-updated",a),g.off("access-toggled",s),g.off("vault-deleted",l)}},[n,b]),y)?(0,s.jsx)(ep,{}):j||!h?(0,s.jsx)(ex,{error:j}):(0,s.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,s.jsx)(z,{vault:h,setIsAddSecretOpen:m}),S&&(null==h?void 0:h.isDeleted)===!1?(0,s.jsx)(em,{isSharedVault:a,secrets:w,searchQuery:i,setSearchQuery:c,visibleSecrets:d,toggleSecretVisibility:e=>{o(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},setIsAddSecretOpen:m}):(null==h?void 0:h.isDeleted)?(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"\uD83D\uDD12 Vault has been deleted."})}):(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"\uD83D\uDD12 Access Denied: You no longer have permission to view the secrets in this vault. Contact the owner to get access."})}),((null==h?void 0:h.ownerId)===(null==p?void 0:p.id)||(null==h||null==(t=h.permissions)?void 0:t.canAdd))&&(0,s.jsx)(E,{open:u,onOpenChange:m})]})}},5492:(e,t,a)=>{Promise.resolve().then(a.bind(a,5186))},5725:(e,t,a)=>{"use strict";a.d(t,{C5:()=>y,MJ:()=>h,Rr:()=>f,eI:()=>p,lR:()=>v,lV:()=>d,zB:()=>u});var s=a(4568),l=a(7620),r=a(9649),n=a(1938),i=a(3928),c=a(2555);let d=n.Op,o=l.createContext({}),u=e=>{let{...t}=e;return(0,s.jsx)(o.Provider,{value:{name:t.name},children:(0,s.jsx)(n.xI,{...t})})},m=()=>{let e=l.useContext(o),t=l.useContext(x),{getFieldState:a,formState:s}=(0,n.xW)(),r=a(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...r}},x=l.createContext({}),p=l.forwardRef((e,t)=>{let{className:a,...r}=e,n=l.useId();return(0,s.jsx)(x.Provider,{value:{id:n},children:(0,s.jsx)("div",{ref:t,className:(0,i.cn)("space-y-2",a),...r})})});p.displayName="FormItem";let v=l.forwardRef((e,t)=>{let{className:a,...l}=e,{error:r,formItemId:n}=m();return(0,s.jsx)(c.J,{ref:t,className:(0,i.cn)(r&&"text-destructive",a),htmlFor:n,...l})});v.displayName="FormLabel";let h=l.forwardRef((e,t)=>{let{...a}=e,{error:l,formItemId:n,formDescriptionId:i,formMessageId:c}=m();return(0,s.jsx)(r.DX,{ref:t,id:n,"aria-describedby":l?"".concat(i," ").concat(c):"".concat(i),"aria-invalid":!!l,...a})});h.displayName="FormControl";let f=l.forwardRef((e,t)=>{let{className:a,...l}=e,{formDescriptionId:r}=m();return(0,s.jsx)("p",{ref:t,id:r,className:(0,i.cn)("text-[0.8rem] text-muted-foreground",a),...l})});f.displayName="FormDescription";let y=l.forwardRef((e,t)=>{var a;let{className:l,children:r,...n}=e,{error:c,formMessageId:d}=m(),o=c?String(null!=(a=null==c?void 0:c.message)?a:""):r;return o?(0,s.jsx)("p",{ref:t,id:d,className:(0,i.cn)("text-[0.8rem] font-medium text-destructive",l),...n,children:o}):null});y.displayName="FormMessage"},5753:(e,t,a)=>{"use strict";a.d(t,{B_:()=>o,Bf:()=>c,I_:()=>i,Ql:()=>r,it:()=>d,kw:()=>l,lY:()=>u,vO:()=>n});var s=a(3084);let l=async e=>(await s.S.post("/collab/invite",e)).data,r=async e=>(await s.S.post("/collab/accept-invite/".concat(e))).data,n=async e=>(await s.S.post("/collab/reject-invite/".concat(e))).data,i=async e=>{var t;return null==(t=(await s.S.get("/collab/invite/".concat(e))).data)?void 0:t.invite},c=async(e,t)=>{var a;return null==(a=(await s.S.get("/invites?type=".concat(e||"sent","&status=").concat(t||"ALL"))).data)?void 0:a.invites},d=async e=>{var t;return null==(t=(await s.S.get("/collab/vault-collaborators/".concat(e))).data)?void 0:t.collaborators},o=async()=>{var e;return null==(e=(await s.S.get("/collab/shared-with-me")).data)?void 0:e.vaults},u=async e=>(await s.S.post("/collab/confirm-access/".concat(e.vaultId),{encryptedVaultKeys:e.finalData})).data},7129:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var s=a(4568),l=a(7620),r=a(3928);let n=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("textarea",{className:(0,r.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});n.displayName="Textarea"},7214:(e,t,a)=>{"use strict";a.d(t,{N:()=>n,_:()=>i});var s=a(1416),l=a(276),r=a(5431);let n=()=>(0,s.I)({queryKey:[r.e.VAULTS],queryFn:l.iF}),i=e=>(0,s.I)({queryKey:r.e.VAULT(e),queryFn:()=>(0,l.Px)(e),enabled:!!e})}}]);